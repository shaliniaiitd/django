define("jira/project/edit/change-triggered-flag",["jira/util/key-code","jquery","aui/flag"],function(e,t,i){"use strict";var l=function(e){this.getValue=e.getValue,this.revert=e.revert,this.warningDescription=e.warningDescription,this.cancelMessage=e.cancelMessage,this.onCancelCallback=e.onCancelCallback,this.flag=null,this.cancelled=!1,this.originalValue=this.getValue(),this.Templates=JIRA.Templates.Project.ChangeTriggeredFlag};return l.prototype.changeOccurred=function(){this.getValue()!==this._getOriginalValue()?null!==this.flag||this.cancelled||this._showFlag():(this._closeFlag(),this._triggerCancellationCallback())},l.prototype._getOriginalValue=function(){return this.originalValue},l.prototype._showFlag=function(){this.flag=i({type:"warning",title:"",body:this.Templates.fieldRevertWarning({message:this.warningDescription,revertMessage:this.cancelMessage})}),t(this.flag).find(".cancel").click(function(e){e.preventDefault(),this.revert(this._getOriginalValue())}.bind(this)),t(this.flag).find(".aui-close-button").click(function(){this.cancelled=!0,this.flag=null}.bind(this)),t(this.flag).find(".aui-close-button").keypress(function(t){t.which!==e.ENTER&&t.which!==e.SPACE||(this.cancelled=!0,this.flag=null)}.bind(this))},l.prototype._closeFlag=function(){this.flag&&(this.flag.close(),this.flag=null)},l.prototype._triggerCancellationCallback=function(){this.onCancelCallback&&this.onCancelCallback()},l.prototype.cleanup=function(){this._closeFlag()},l});