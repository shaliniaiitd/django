define("jira/field/assignee-picker",["jira/util/formatter","jira/ajs/select/single-select","jira/ajs/select/suggestions/assignee-suggest-handler","jira/ajs/list/group-descriptor","jira/ajs/list/item-descriptor","wrm/context-path","aui/params","jquery"],function(e,t,s,i,a,r,n,o){"use strict";var u=r();return t.extend({init:function(t){function r(e){return n.actionDescriptorId=void 0,AJS.populateParameters(),{username:e,projectKeys:n.projectKeys,issueKey:n.assigneeEditIssueKey,actionDescriptorId:n.actionDescriptorId,maxResults:100}}function l(t){var s=[];if(t.length){for(var r=new i({weight:1,id:"assignee-group-search",uniqueItemScope:"container",replace:!0,label:e.I18n.getText("assignee.picker.group.search")}),n=0,o=t.length;n<o;n++){var u=t[n],l=u.name,c=u.displayName,d=u.emailAddress,p=c;d&&(p+=" - "+d),p+=" ("+l+")",r.addItem(new a({value:l,fieldText:c,label:p,allowDuplicate:!0,icon:u.avatarUrls["16x16"],iconType:"rounded"}))}s.push(r)}return s}var c=t.element instanceof o?t.element:o(t.element);t=o.extend(!0,{},{submitInputVal:!0,showDropdownButton:!!c.data("show-dropdown-button"),errorMessage:e.I18n.getText("assignee.picker.invalid.user"),localDataGroupId:"assignee-group-suggested",content:"mixed",iconType:"rounded",suggestionAtTop:!0,removeDuplicates:!1,disableRemoveSelected:!0,ajaxOptions:{url:function(){n.assigneeEditIssueKey=void 0,AJS.populateParameters();var e=n.assigneeEditIssueKey?"search":"multiProjectSearch";return u+"/rest/api/latest/user/assignable/"+e},minQueryLength:0,data:r,formatResponse:l}},t),"-1"===t.editValue&&(t.editValue=!1,c.val("-1")),this._super(t),this.suggestionsHandler=new s(this.options,this.model)},handleFreeInput:function(e){""===o.trim(e||this.$field.val())?this.setSelection(this.model.getDescriptor("-1")):this._super(e),this.lastQuery=this.getQueryVal()},_handleCharacterInput:function(e){this.lastQuery!==this.getQueryVal()?this._super(e):e&&this.showSuggestions(),this.lastQuery=this.getQueryVal()},cleanUpModel:function(){}})}),AJS.namespace("JIRA.AssigneePicker",null,require("jira/field/assignee-picker"));