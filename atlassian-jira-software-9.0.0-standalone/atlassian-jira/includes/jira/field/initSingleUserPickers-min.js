define("jira/field/init-single-user-pickers",["jquery","wrm/context-path","jira/ajs/select/single-select","jira/util/events/reasons","jira/util/events/types","jira/util/events","jira/field/user-picker-util","jira/util/formatter","jira/field/create-user-picker-popup-trigger","jira/ajs/list/item-descriptor"],function(e,r,t,i,a,n,s,o,p,u){"use strict";function c(e){return e&&-1!==e.indexOf("customfield_")}function d(r){e(".js-default-user-picker",r).each(function(){var r=e(this);if(!r.data("aui-ss")){var i=c(r.attr("name")),a=i?"/rest/api/1.0/users/picker":"/rest/api/2/user/picker",n={showAvatar:!0,fieldName:i?r.prop("name"):void 0,fieldConfigId:i?r.data("field-config-id"):void 0,projectId:i?r.data("project-ids").split(",").filter(function(e){return e}):void 0},d=r.data("inputValue");r.data("has-popup-picker")&&r.next(".popup-trigger").on("click",p.createUserPickerPopupTrigger({urlBase:l,formName:r.data("form-name")||r.closest("form").attr("name"),fieldName:r.prop("name"),fieldConfigId:r.data("field-config-id"),projectIds:r.data("project-ids")?r.data("project-ids").split(",").filter(function(e){return e}):void 0,triggerEvent:"userpicker:onPopUpSelection"})),new t({element:r,submitInputVal:!0,hasAddonIcon:!!r.data("has-popup-picker"),showDropdownButton:!!r.data("show-dropdown-button"),errorMessage:o.I18n.getText("user.picker.invalid.user","'{0}'"),iconType:"rounded",ajaxOptions:{url:l+a,data:n,formatResponse:s.formatResponse},inputText:d,ariaLabel:o.I18n.getText("user.picker.select.user"),events:{element:{"userpicker:onPopUpSelection":function(r,t,i,a){e.ajax({url:l+"/rest/api/2/user?username="+a,type:"GET",contentType:"application/json",success:function(e){i.setSelection(new u({value:a,label:e.displayName,icon:e.avatarUrls["24x24"]}),!0)},error:function(e){return console.error(e)}})}}}})}})}var l=r();return n.bind(a.NEW_CONTENT_ADDED,function(e,r,t){t!==i.panelRefreshed&&d(r)}),d});